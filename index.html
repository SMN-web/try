<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>RSA Key Pair Generator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    textarea { width: 100%; height: 100px; margin: 10px 0; }
    button { font-size: 1.1em; }
  </style>
</head>
<body>
  <h2>RSA 2048 Key Pair Generator</h2>
  <button onclick="generate()">Generate Key Pair</button>
  <div id="result" style="margin-top:20px;"></div>
  <script>
    async function generate() {
      const resultDiv = document.getElementById('result');
      resultDiv.innerHTML = 'Generating... Please wait.';

      // Generate the key
      const keyPair = await window.crypto.subtle.generateKey(
        {
          name: "RSASSA-PKCS1-v1_5",
          modulusLength: 2048,
          publicExponent: new Uint8Array([1, 0, 1]),
          hash: "SHA-256"
        },
        true,
        ["sign", "verify"]
      );

      // Export as PEM
      function toPem(buffer, label) {
        const b64 = btoa(String.fromCharCode(...new Uint8Array(buffer)));
        const lines = b64.match(/.{1,64}/g).join('\n');
        return `-----BEGIN ${label}-----\n${lines}\n-----END ${label}-----\n`;
      }
      const pkcs8 = await window.crypto.subtle.exportKey("pkcs8", keyPair.privateKey);
      const spki = await window.crypto.subtle.exportKey("spki", keyPair.publicKey);

      resultDiv.innerHTML = `
        <h3>Private Key (keep this secret!)</h3>
        <textarea readonly>${toPem(pkcs8, "PRIVATE KEY")}</textarea>
        <h3>Public Key</h3>
        <textarea readonly>${toPem(spki, "PUBLIC KEY")}</textarea>
      `;
    }
  </script>
</body>
</html>
